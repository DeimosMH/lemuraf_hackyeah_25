<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Odyssey: The Life Navigation RPG (Blueprint Edition)</title>
    <!-- Chosen Palette: Warm Neutrals (bg-slate-50) with Soft Blue (sky-500) and Emerald Green (emerald-500) Accents -->
    <!-- Application Structure Plan: A five-tab SPA: 1. Dashboard (Character/Quests - Immediate user actions). 2. Logistics (Trip/Prediction - Transport focus). 3. Simulator (Future Projection - Long-term goal impact). 4. Community (Events/Calmcation - Social/Wellness travel). 5. Blueprint (Market Analysis/Roadmap - Strategic report data). This structure separates the user-facing RPG experience from the strategic business and technical documentation, ensuring both content types are explorable without overwhelming the primary user interface. Key interactions include tab navigation, dynamic chart updates, list filtering, and simulation sliders. -->
    <!-- Visualization & Content Choices: 1. Character Stats -> Goal: Inform/Compare -> Viz: Radar Chart -> Interaction: Updates on quest completion -> Library: Chart.js. 2. Future Projections -> Goal: Change over time -> Viz: Line Chart (Life Run) -> Interaction: Slider adjusts projection (Habit Success Rate) -> Library: Chart.js. 3. Market Growth -> Goal: Compare/Inform -> Viz: Horizontal Bar Chart (CAGR) -> Interaction: Static view of projected growth -> Library: Chart.js. 4. Roadmap -> Goal: Organize/Change -> Viz: HTML/CSS Timeline -> Interaction: Clickable details -> Library: Vanilla JS/Tailwind CSS. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc;
        }
        .chart-container {
            position: relative;
            width: 100%;
            height: 40vh;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 50vh;
            }
        }
        .nav-link {
            transition: all 0.2s ease-in-out;
        }
        .nav-link.active {
            color: #0ea5e9;
            border-bottom-color: #0ea5e9;
        }
    </style>
</head>
<body class="text-slate-800">

    <div id="app-container" class="min-h-screen">

        <header class="bg-white shadow-sm sticky top-0 z-10">
            <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between items-center py-4">
                    <div class="flex items-center space-x-2">
                        <span class="text-2xl font-bold text-sky-600">O</span>
                        <h1 class="text-xl font-bold text-slate-800">Odyssey</h1>
                    </div>
                    <div class="hidden md:flex items-center space-x-8">
                        <a href="#dashboard" class="nav-link text-slate-600 hover:text-sky-500 border-b-2 border-transparent pb-1 font-semibold active" data-section="dashboard">Dashboard</a>
                        <a href="#logistics" class="nav-link text-slate-600 hover:text-sky-500 border-b-2 border-transparent pb-1 font-semibold" data-section="logistics">Logistics</a>
                        <a href="#simulator" class="nav-link text-slate-600 hover:text-sky-500 border-b-2 border-transparent pb-1 font-semibold" data-section="simulator">Simulator</a>
                        <a href="#community" class="nav-link text-slate-600 hover:text-sky-500 border-b-2 border-transparent pb-1 font-semibold" data-section="community">Community</a>
                        <a href="#blueprint" class="nav-link text-slate-600 hover:text-sky-500 border-b-2 border-transparent pb-1 font-semibold" data-section="blueprint">Blueprint</a>
                    </div>
                    <div class="md:hidden">
                         <button id="mobile-menu-button" class="text-slate-600 hover:text-sky-500">
                             <span class="text-xl">â˜°</span>
                         </button>
                    </div>
                </div>
                 <div id="mobile-menu" class="md:hidden hidden flex flex-col space-y-2 pb-4">
                    <a href="#dashboard" class="nav-link text-slate-600 hover:text-sky-500 block px-2 py-1 font-semibold active" data-section="dashboard">Dashboard</a>
                    <a href="#logistics" class="nav-link text-slate-600 hover:text-sky-500 block px-2 py-1 font-semibold" data-section="logistics">Logistics</a>
                    <a href="#simulator" class="nav-link text-slate-600 hover:text-sky-500 block px-2 py-1 font-semibold" data-section="simulator">Simulator</a>
                    <a href="#community" class="nav-link text-slate-600 hover:text-sky-500 block px-2 py-1 font-semibold" data-section="community">Community</a>
                    <a href="#blueprint" class="nav-link text-slate-600 hover:text-sky-500 block px-2 py-1 font-semibold" data-section="blueprint">Blueprint</a>
                </div>
            </nav>
        </header>

        <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

            <section id="dashboard" class="app-section">
                <p class="text-slate-500 mb-6">The Dashboard is your **Integrated Life OS**, unifying transport, health, and social achievements into a single gamified interface. Completing the daily **Quests** drives progression.</p>
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <div class="lg:col-span-2">
                        <div class="bg-white p-6 rounded-xl shadow-md">
                            <h2 class="text-2xl font-bold mb-1">Character Sheet</h2>
                            <p class="text-slate-500 mb-4">This is your core self. Improvements here are the direct result of the **cross-system experience point (XP)** system.</p>
                            <div class="chart-container max-w-lg mx-auto">
                                <canvas id="statsChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div>
                        <div class="bg-white p-6 rounded-xl shadow-md mb-6">
                            <h3 id="char-level" class="text-lg font-bold">Alex <span class="text-sm font-medium text-slate-500">Lv. 12</span></h3>
                             <p class="text-sm text-slate-500 mb-2">Experience Points</p>
                            <div class="w-full bg-slate-200 rounded-full h-4">
                                <div id="xp-bar" class="bg-sky-500 h-4 rounded-full transition-all duration-500" style="width: 45%;"></div>
                            </div>
                             <p id="xp-text" class="text-right text-sm text-slate-500 mt-1">450 / 1000 XP</p>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-md">
                            <h2 class="text-2xl font-bold mb-4">Daily Quests</h2>
                            <div id="quest-list" class="space-y-4"></div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="logistics" class="app-section hidden">
                 <h2 class="text-3xl font-bold mb-2">Logistics Dashboard: The Oracle</h2>
                 <p class="text-slate-500 mb-8">This module provides **Predictive Disruption Management**. It uses the **GTFS-Realtime** data to generate **Delay Risk Scores (DRS)**, giving you up to 25 minutes advance warning of likely disruptions.</p>
                 <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                     <div>
                        <h3 class="text-2xl font-bold mb-4">Trip Predictions & DRS</h3>
                        <div id="trip-list" class="space-y-4"></div>
                        <div class="mt-6 p-4 rounded-xl bg-emerald-50 border border-emerald-200">
                             <p class="font-bold text-emerald-800">Evasion Points System</p>
                             <p class="text-sm text-emerald-700">Successfully avoiding predicted delays earns you **Evasion Points**, which contribute to your overall Resilience stat.</p>
                        </div>
                     </div>
                     <div>
                        <h3 class="text-2xl font-bold mb-4">Travel Quests & Inventory</h3>
                        <div id="travel-quest-list" class="space-y-4"></div>
                     </div>
                 </div>
            </section>

            <section id="simulator" class="app-section hidden">
                <h2 class="text-3xl font-bold mb-2">Future Self Simulator: The Life Run</h2>
                <p class="text-slate-500 mb-8">This system uses **behavioral modeling** and **Monte Carlo-style projections** to visualize the long-term impact of your daily choices across health, career, and personal development. </p>
                 <div class="bg-white p-6 rounded-xl shadow-md">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8 items-center">
                        <div class="md:col-span-2">
                             <div class="chart-container max-w-2xl mx-auto h-96">
                                <canvas id="futureChart"></canvas>
                            </div>
                        </div>
                        <div>
                             <h3 class="text-xl font-bold mb-4">Simulated Outcomes (1 Year)</h3>
                             <ul class="list-disc list-inside space-y-2 text-slate-600 mb-6">
                                 <li>**Health-Guard:** On-device ML analysis of physiological data.</li>
                                 <li>**Impact:** Visualizes stat changes (Vitality, Prosperity).</li>
                                 <li>**Risk:** Predicts burnout based on resilience depletion.</li>
                             </ul>
                            <label for="success-rate" class="block text-sm font-medium text-slate-700">Monthly Habit Success Rate</label>
                            <div class="flex items-center space-x-4 mt-2">
                                <input id="success-rate" type="range" min="0" max="100" value="75" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer">
                                <span id="success-rate-value" class="font-bold text-sky-600 text-lg">75%</span>
                            </div>
                             <div id="simulation-narrative" class="mt-6 bg-slate-100 p-4 rounded-lg">
                                <p class="font-semibold">Projected Future Self:</p>
                                <p class="text-sm text-slate-600">Level 45, High Prosperity and Vitality, **Epic Challenge Success: 90%**.</p>
                             </div>
                        </div>
                    </div>
                 </div>
            </section>

            <section id="community" class="app-section hidden">
                <h2 class="text-3xl font-bold mb-2">The Guild Hall: Wellness & Culture</h2>
                <p class="text-slate-500 mb-6">Discover local events and embrace the **Calmcation** trend through AI-powered wellness destination scoring and **Cultural Exchange Missions**.</p>
                <div class="mb-6">
                    <h3 class="text-lg font-semibold mb-3">Filter by Interest</h3>
                    <div id="interest-tags" class="flex flex-wrap gap-2">
                        <button class="interest-tag bg-sky-500 text-white px-4 py-1 rounded-full text-sm font-semibold" data-interest="all">All</button>
                        <button class="interest-tag bg-white text-slate-600 px-4 py-1 rounded-full text-sm font-semibold border border-slate-300 hover:bg-slate-100" data-interest="hiking">Hiking</button>
                        <button class="interest-tag bg-white text-slate-600 px-4 py-1 rounded-full text-sm font-semibold border border-slate-300 hover:bg-slate-100" data-interest="coding">Coding</button>
                        <button class="interest-tag bg-white text-slate-600 px-4 py-1 rounded-full text-sm font-semibold border border-slate-300 hover:bg-slate-100" data-interest="photography">Photography</button>
                        <button class="interest-tag bg-white text-slate-600 px-4 py-1 rounded-full text-sm font-semibold border border-slate-300 hover:bg-slate-100" data-interest="reading">Reading</button>
                    </div>
                </div>
                <div id="event-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                </div>
            </section>

            <section id="blueprint" class="app-section hidden">
                <h2 class="text-3xl font-bold mb-2">Strategic Blueprint: Market & Architecture</h2>
                <p class="text-slate-500 mb-8">Explore the core drivers, market opportunity, and technical roadmap underpinning the Odyssey platform. This section synthesizes the **Comprehensive Market Analysis & Technical Blueprint** document.</p>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                    <div class="bg-white p-5 rounded-xl shadow-md border-t-4 border-sky-500">
                        <p class="text-sm text-slate-500">Total Market Opportunity</p>
                        <p class="text-3xl font-extrabold text-slate-800 mt-1">$240B+</p>
                        <p class="text-xs text-emerald-500 mt-2">Combined markets (Habits, Wellness, Logistics)</p>
                    </div>
                     <div class="bg-white p-5 rounded-xl shadow-md border-t-4 border-emerald-500">
                        <p class="text-sm text-slate-500">Gamification Advantage</p>
                        <p class="text-3xl font-extrabold text-slate-800 mt-1">25-40%</p>
                        <p class="text-xs text-emerald-700 mt-2">Higher retention rates than traditional apps.</p>
                    </div>
                    <div class="bg-white p-5 rounded-xl shadow-md border-t-4 border-amber-500">
                        <p class="text-sm text-slate-500">Core Revenue Model</p>
                        <p class="text-3xl font-extrabold text-slate-800 mt-1">1% + â‚¬4.99</p>
                        <p class="text-xs text-amber-700 mt-2">Travel fees + Premium Subscription (aligned success)</p>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <div>
                        <div class="bg-white p-6 rounded-xl shadow-md">
                            <h3 class="text-xl font-bold mb-4">Market Growth Projections (CAGR)</h3>
                            <p class="text-sm text-slate-500 mb-4">Projected Compounded Annual Growth Rate for key target markets (2024-2033).</p>
                            <div class="chart-container h-[50vh] max-w-xl mx-auto">
                                <canvas id="marketChart"></canvas>
                            </div>
                        </div>
                    </div>
                    <div>
                        <div class="bg-white p-6 rounded-xl shadow-md">
                            <h3 class="text-xl font-bold mb-4">Technical Roadmap & Milestones</h3>
                            <p class="text-sm text-slate-500 mb-4">Phased implementation strategy using Flutter, Kotlin-Ktor, and established APIs.</p>
                            <div id="roadmap-timeline" class="space-y-6 pt-2">
                                <div class="relative pl-8 border-l-2 border-slate-200">
                                    <div class="absolute w-4 h-4 rounded-full bg-emerald-500 -left-2 top-0"></div>
                                    <p class="font-bold text-lg mb-1">MVP (0-3 Months)</p>
                                    <p class="text-sm text-slate-600">Flutter app shell, basic habit tracking, wallet integration. Target: 40% Day-1 retention.</p>
                                </div>
                                <div class="relative pl-8 border-l-2 border-slate-200">
                                    <div class="absolute w-4 h-4 rounded-full bg-sky-500 -left-2 top-0"></div>
                                    <p class="font-bold text-lg mb-1">Phase 1 (3-6 Months)</p>
                                    <p class="text-sm text-slate-600">**Transport integration** (DRS/The Oracle) and 1-tap booking. Target: 10,000 trips booked.</p>
                                </div>
                                <div class="relative pl-8 border-l-2 border-slate-200">
                                    <div class="absolute w-4 h-4 rounded-full bg-amber-500 -left-2 top-0"></div>
                                    <p class="font-bold text-lg mb-1">Phase 2 (6-9 Months)</p>
                                    <p class="text-sm text-slate-600">**Health tracking ML** (Health-Guard) with wearable connections (Oura, Whoop). Target: 50% MAU wearable linkage.</p>
                                </div>
                                <div class="relative pl-8">
                                    <div class="absolute w-4 h-4 rounded-full bg-red-500 -left-2 top-0"></div>
                                    <p class="font-bold text-lg mb-1">Phase 3 (9-12 Months)</p>
                                    <p class="text-sm text-slate-600">**Future Self Simulator** launch, guild challenges, and advanced travel features. Target: 20% premium subscription rate.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="mt-8 bg-white p-6 rounded-xl shadow-md">
                     <h3 class="text-2xl font-bold mb-4">Core Innovation Breakdown</h3>
                     <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                         <div class="p-4 bg-slate-50 rounded-lg border">
                             <p class="font-bold text-sky-600">The Oracle</p>
                             <p class="text-sm text-slate-600">ML-driven **Delay Risk Scores** for transport using aggregated real-time operator and crowd-sourced data.</p>
                         </div>
                         <div class="p-4 bg-slate-50 rounded-lg border">
                             <p class="font-bold text-emerald-600">Future Self Simulator</p>
                             <p class="text-sm text-slate-600">**Behavioral modeling** and **Monte Carlo** projections to visualize long-term habit impact across life domains.</p>
                         </div>
                         <div class="p-4 bg-slate-50 rounded-lg border">
                             <p class="font-bold text-amber-600">Health-Guard</p>
                             <p class="text-sm text-slate-600">On-device ML analysis of physiological data (HRV, sleep) from wearables for real-time recovery suggestions.</p>
                         </div>
                     </div>
                </div>
            </section>

        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            const state = {
                character: {
                    level: 12,
                    xp: 450,
                    xp_needed: 1000,
                    stats: {
                        vitality: 70,
                        cognition: 85,
                        resilience: 60,
                        prosperity: 50
                    }
                },
                quests: [
                    { id: 1, text: "Complete morning workout", type: "daily", stat: "vitality", xp: 20, done: false },
                    { id: 2, text: "30 mins of deep work", type: "daily", stat: "cognition", xp: 30, done: true },
                    { id: 3, text: "Meditate for 10 minutes", type: "daily", stat: "resilience", xp: 15, done: false },
                    { id: 4, text: "Review daily budget", type: "daily", stat: "prosperity", xp: 10, done: false },
                    { id: 5, text: "Finish project report", type: "todo", stat: "cognition", xp: 100, done: false },
                ],
                trips: [
                    { id: 1, name: "Commute to Work", time: "8:30 AM", drs: 75, risk: "High", isEvasible: true },
                    { id: 2, name: "Train to Central Station", time: "2:00 PM", drs: 15, risk: "Low", isEvasible: false },
                    { id: 3, name: "Bus to Airport", time: "6:00 PM", drs: 45, risk: "Medium", isEvasible: true },
                ],
                travel_quests: [
                    { id: 1, title: "Recharge: Forest Bathing", type: "Calmcation", reward: "+10 Vitality Buff", desc: "Spend a day at the national park, disconnected from devices (Wellness Destination Scoring)." },
                    { id: 2, title: "Cultural Exchange: Market Day", type: "Cultural", reward: "New Recipe Item", desc: "Gamify meaningful local interaction (Workaway/HelpX concepts)." },
                ],
                events: [
                    { id: 1, name: "Weekend Mountain Trek", interest: "hiking", location: "Green Valley Park" },
                    { id: 2, name: "Intro to Python Workshop", interest: "coding", location: "Tech Hub Downtown" },
                    { id: 3, name: "Golden Hour Photo Walk", interest: "photography", location: "City Waterfront" },
                    { id: 4, name: "Sci-Fi Book Club Meetup", interest: "reading", location: "The Grand Library" },
                    { id: 5, name: "Hackathon Kick-off", interest: "coding", location: "Innovation Center" },
                    { id: 6, name: "Advanced Landscape Photography", interest: "photography", location: "Sunset Point" }
                ],
                activeSection: 'dashboard'
            };

            const sections = document.querySelectorAll('.app-section');
            const navLinks = document.querySelectorAll('.nav-link');
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');

            let statsChart, futureChart, marketChart;

            function navigate(sectionId) {
                state.activeSection = sectionId;
                sections.forEach(section => {
                    if (section.id === sectionId) {
                        section.classList.remove('hidden');
                    } else {
                        section.classList.add('hidden');
                    }
                });

                navLinks.forEach(link => {
                    if (link.dataset.section === sectionId) {
                        link.classList.add('active');
                    } else {
                        link.classList.remove('active');
                    }
                });

                if(!mobileMenu.classList.contains('hidden')){
                    mobileMenu.classList.add('hidden');
                }
            }

            navLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    e.preventDefault();
                    navigate(e.target.dataset.section);
                });
            });

            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
            });

            function updateXPBar() {
                const xpBar = document.getElementById('xp-bar');
                const xpText = document.getElementById('xp-text');
                const levelEl = document.getElementById('char-level');
                const percentage = (state.character.xp / state.character.xp_needed) * 100;
                xpBar.style.width = `${percentage}%`;
                xpText.textContent = `${state.character.xp} / ${state.character.xp_needed} XP`;
                levelEl.innerHTML = `Alex <span class="text-sm font-medium text-slate-500">Lv. ${state.character.level}</span>`;
            }

            function renderQuests() {
                const questList = document.getElementById('quest-list');
                questList.innerHTML = '';
                state.quests.forEach(quest => {
                    const questEl = document.createElement('div');
                    questEl.className = 'flex items-center justify-between';
                    questEl.innerHTML = `
                        <div class="flex items-center">
                            <input type="checkbox" id="quest-${quest.id}" data-id="${quest.id}" class="h-5 w-5 rounded border-gray-300 text-sky-600 focus:ring-sky-500 cursor-pointer" ${quest.done ? 'checked' : ''}>
                            <label for="quest-${quest.id}" class="ml-3 text-sm ${quest.done ? 'text-slate-400 line-through' : 'text-slate-700'} cursor-pointer">${quest.text}</label>
                        </div>
                        <span class="text-xs font-bold text-emerald-500">+${quest.xp} XP</span>
                    `;
                    questList.appendChild(questEl);
                });

                document.querySelectorAll('#quest-list input[type="checkbox"]').forEach(checkbox => {
                    checkbox.addEventListener('change', (e) => {
                        handleQuestToggle(parseInt(e.target.dataset.id), e.target.checked);
                    });
                });
            }

            function handleQuestToggle(questId, isDone) {
                const quest = state.quests.find(q => q.id === questId);
                if (!quest || quest.done === isDone) return;

                quest.done = isDone;

                if (isDone) {
                    state.character.xp += quest.xp;
                    state.character.stats[quest.stat] = Math.min(100, state.character.stats[quest.stat] + 5);
                } else {
                    state.character.xp -= quest.xp;
                    state.character.stats[quest.stat] = Math.max(0, state.character.stats[quest.stat] - 5);
                }
                
                if (state.character.xp >= state.character.xp_needed) {
                    state.character.level += 1;
                    state.character.xp = state.character.xp - state.character.xp_needed;
                    state.character.xp_needed = state.character.xp_needed + 500;
                }

                updateXPBar();
                renderQuests();
                updateStatsChart();
            }

            function renderTrips() {
                const tripList = document.getElementById('trip-list');
                tripList.innerHTML = '';
                state.trips.forEach(trip => {
                    let riskColorClass = 'bg-emerald-100 text-emerald-800';
                    let riskBarColor = 'bg-emerald-500';
                    if (trip.risk === 'Medium') {
                        riskColorClass = 'bg-amber-100 text-amber-800';
                        riskBarColor = 'bg-amber-500';
                    } else if (trip.risk === 'High') {
                        riskColorClass = 'bg-red-100 text-red-800';
                        riskBarColor = 'bg-red-500';
                    }

                    const evasionButton = trip.isEvasible ? `<button class="text-xs bg-sky-600 text-white font-bold py-1 px-3 rounded-md hover:bg-sky-700">Evade</button>` : `<span class="text-xs text-slate-500">Not Evasible</span>`;

                    const tripEl = document.createElement('div');
                    tripEl.className = 'bg-white p-4 rounded-xl shadow-md';
                    tripEl.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div>
                                <p class="font-bold">${trip.name}</p>
                                <p class="text-sm text-slate-500">${trip.time}</p>
                            </div>
                             <span class="text-xs font-bold px-2 py-1 rounded-full ${riskColorClass}">${trip.risk} Risk</span>
                        </div>
                        <div class="mt-3">
                            <p class="text-sm font-medium mb-1">Delay Risk Score (DRS): ${trip.drs}%</p>
                            <div class="w-full bg-slate-200 rounded-full h-2.5">
                                <div class="${riskBarColor} h-2.5 rounded-full" style="width: ${trip.drs}%"></div>
                            </div>
                        </div>
                        <div class="mt-3 flex justify-between items-center">
                            <p class="text-xs text-slate-500">25 min advance warning</p>
                            ${evasionButton}
                        </div>
                    `;
                    tripList.appendChild(tripEl);
                });
            }

             function renderTravelQuests() {
                const travelQuestList = document.getElementById('travel-quest-list');
                travelQuestList.innerHTML = '';
                state.travel_quests.forEach(quest => {
                    const questEl = document.createElement('div');
                    questEl.className = 'bg-white p-4 rounded-xl shadow-md';
                    questEl.innerHTML = `
                         <p class="text-xs font-semibold ${quest.type === 'Calmcation' ? 'text-sky-600' : 'text-emerald-600'}">${quest.type}</p>
                         <p class="font-bold mt-1">${quest.title}</p>
                         <p class="text-sm text-slate-500 mt-1">${quest.desc}</p>
                         <div class="mt-3 flex justify-between items-center">
                            <p class="text-sm font-medium text-amber-600">Reward: ${quest.reward}</p>
                            <button class="text-xs bg-slate-700 text-white font-bold py-1 px-3 rounded-md hover:bg-slate-800">Book Now</button>
                         </div>
                    `;
                    travelQuestList.appendChild(questEl);
                });
             }

            function renderEvents() {
                const eventList = document.getElementById('event-list');
                eventList.innerHTML = '';
                state.events.forEach(event => {
                    const eventEl = document.createElement('div');
                    eventEl.className = 'event-card bg-white p-4 rounded-xl shadow-md transition-all duration-300';
                    eventEl.dataset.interest = event.interest;
                    eventEl.innerHTML = `
                        <p class="font-bold">${event.name}</p>
                        <p class="text-sm text-slate-500">${event.location}</p>
                        <p class="text-xs font-semibold capitalize mt-2 text-sky-600">${event.interest}</p>
                    `;
                    eventList.appendChild(eventEl);
                });
            }

            function filterEvents(interest) {
                document.querySelectorAll('.event-card').forEach(card => {
                    if (interest === 'all' || card.dataset.interest === interest) {
                        card.classList.remove('hidden');
                    } else {
                        card.classList.add('hidden');
                    }
                });
                 document.querySelectorAll('.interest-tag').forEach(tag => {
                     if(tag.dataset.interest === interest) {
                         tag.classList.add('bg-sky-500', 'text-white');
                         tag.classList.remove('bg-white', 'text-slate-600');
                     } else {
                         tag.classList.remove('bg-sky-500', 'text-white');
                         tag.classList.add('bg-white', 'text-slate-600');
                     }
                 })
            }

            document.querySelectorAll('.interest-tag').forEach(tag => {
                tag.addEventListener('click', (e) => {
                    filterEvents(e.target.dataset.interest);
                });
            });

            function createStatsChart() {
                const ctx = document.getElementById('statsChart').getContext('2d');
                statsChart = new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: ['Vitality', 'Cognition', 'Resilience', 'Prosperity'],
                        datasets: [{
                            label: 'Character Stats',
                            data: Object.values(state.character.stats),
                            backgroundColor: 'rgba(56, 189, 248, 0.2)',
                            borderColor: 'rgb(14, 165, 233)',
                            pointBackgroundColor: 'rgb(14, 165, 233)',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: 'rgb(14, 165, 233)'
                        }]
                    },
                    options: {
                        maintainAspectRatio: false,
                        responsive: true,
                        scales: {
                            r: {
                                angleLines: { display: true, color: 'rgba(0, 0, 0, 0.1)' },
                                suggestedMin: 0,
                                suggestedMax: 100,
                                pointLabels: { font: { size: 14, weight: 'bold' } },
                                grid: { color: 'rgba(0, 0, 0, 0.1)' },
                                ticks: {
                                    backdropColor: 'rgba(0,0,0,0)',
                                    stepSize: 20
                                }
                            }
                        },
                        plugins: {
                            legend: {
                                display: false
                            }
                        }
                    }
                });
            }

            function updateStatsChart() {
                if (statsChart) {
                    statsChart.data.datasets[0].data = Object.values(state.character.stats);
                    statsChart.update();
                }
            }

            function createFutureChart() {
                const ctx = document.getElementById('futureChart').getContext('2d');
                futureChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Start', '3 Months', '6 Months', '9 Months', '1 Year'],
                        datasets: [{
                            label: 'Projected Level',
                            borderColor: 'rgb(14, 165, 233)',
                            backgroundColor: 'rgba(56, 189, 248, 0.1)',
                            fill: true,
                            tension: 0.4,
                        }]
                    },
                    options: {
                        maintainAspectRatio: false,
                        responsive: true,
                         scales: {
                            y: {
                                beginAtZero: false,
                                title: { display: true, text: 'Character Level' }
                            }
                        },
                        plugins: {
                            legend: { display: false },
                            title: { display: true, text: 'Future Self Level Projection (Life Run)', font: { size: 16 } }
                        }
                    }
                });
                updateFutureChart(75);
            }

            function updateFutureChart(successRate) {
                if (!futureChart) return;
                const baseLevel = state.character.level;
                const rate = successRate / 100;

                const projectedData = [
                    baseLevel,
                    baseLevel + (15 * rate),
                    baseLevel + (30 * rate * (1 + rate / 2)),
                    baseLevel + (45 * rate * (1 + rate)),
                    baseLevel + (60 * rate * (1 + rate * 1.5)),
                ].map(level => Math.round(level));

                futureChart.data.datasets[0].data = projectedData;
                futureChart.update();

                const finalLevel = projectedData[projectedData.length-1];
                const narrativeEl = document.getElementById('simulation-narrative');
                let narrativeText;
                let successText;

                if (rate > 0.8) {
                    narrativeText = `Level ${finalLevel}, High Prosperity and Vitality.`;
                    successText = `**Epic Challenge Success: ~${Math.round(rate*100)}%** (Strong Health-Guard status).`;
                } else if (rate > 0.5) {
                    narrativeText = `Level ${finalLevel}, Balanced stats, steady progress.`;
                    successText = `**Epic Challenge Success: ~${Math.round(rate*100)}%**.`;
                } else if (rate > 0.2) {
                    narrativeText = `Level ${finalLevel}, Low Prosperity and High Stress.`;
                     successText = `**Epic Challenge Success: ~${Math.round(rate*100)}%** (Burnout risk: Medium).`;
                } else {
                     narrativeText = `Level ${finalLevel}, Stagnant growth, significant challenges.`;
                     successText = `**Epic Challenge Success: ~${Math.round(rate*100)}%** (Burnout risk: High).`;
                }

                narrativeEl.innerHTML = `
                    <p class="font-semibold">Projected Future Self:</p>
                    <p class="text-sm text-slate-600">${narrativeText} ${successText.replace(/\*\*(.*?)\*\*/g, '<strong class="text-slate-800">$1</strong>')}</p>
                `;
            }

            function createMarketChart() {
                const ctx = document.getElementById('marketChart').getContext('2d');
                marketChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['Habit Tracking', 'Wellness Tourism', 'Gamification Apps'],
                        datasets: [{
                            label: 'Projected CAGR (2024-2033)',
                            data: [14.2, 13, 14.5], 
                            backgroundColor: ['rgba(14, 165, 233, 0.7)', 'rgba(16, 185, 129, 0.7)', 'rgba(251, 191, 36, 0.7)'],
                            borderColor: ['rgb(14, 165, 233)', 'rgb(16, 185, 129)', 'rgb(251, 191, 36)'],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        maintainAspectRatio: false,
                        indexAxis: 'y',
                        responsive: true,
                        scales: {
                            x: {
                                beginAtZero: true,
                                title: { display: true, text: 'CAGR (%)' }
                            }
                        },
                        plugins: {
                            legend: { display: false },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        let label = context.dataset.label || '';
                                        if (label) {
                                            label += ': ';
                                        }
                                        if (context.parsed.x !== null) {
                                            label += context.parsed.x.toFixed(1) + '%';
                                        }
                                        return label;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            const successSlider = document.getElementById('success-rate');
            const successValue = document.getElementById('success-rate-value');

            successSlider.addEventListener('input', (e) => {
                const value = e.target.value;
                successValue.textContent = `${value}%`;
                updateFutureChart(parseInt(value));
            });

            function init() {
                navigate('dashboard');
                createStatsChart();
                createFutureChart();
                createMarketChart();
                updateXPBar();
                renderQuests();
                renderTrips();
                renderTravelQuests();
                renderEvents();
            }

            init();
        });
    </script>

</body>
</html>
